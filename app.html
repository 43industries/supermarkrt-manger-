<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supermarket Management System</title>
    
    <!-- Offline Resource Loader - Loads from local files, falls back to CDN if needed -->
    <script src="offline-loader.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // Icons as React components
        const iconSize = 24;
        
        const ShoppingCart = ({ size = iconSize, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="8" cy="21" r="1"/>
                <circle cx="19" cy="21" r="1"/>
                <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
            </svg>
        );
        
        const LogOut = ({ size = iconSize, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                <polyline points="16 17 21 12 16 7"/>
                <line x1="21" x2="9" y1="12" y2="12"/>
            </svg>
        );
    </script>
    
    <!-- Load the main app component -->
    <script type="text/babel">
        // Load app.js dynamically with error handling
        fetch('app.js')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.text();
            })
            .then(code => {
                console.log('✅ app.js loaded successfully');
                try {
                    // Execute the code with Babel transformation
                    const transformed = Babel.transform(code, { presets: ['react'] }).code;
                    eval(transformed);
                    console.log('✅ App initialized successfully');
                } catch (error) {
                    console.error('❌ Error executing app.js:', error);
                    document.getElementById('root').innerHTML = `
                        <div style="padding: 50px; text-align: center; font-family: Arial;">
                            <h1 style="color: red; margin-bottom: 20px;">Error Loading Application</h1>
                            <p style="color: #666; margin-bottom: 10px;">There was an error processing the code:</p>
                            <pre style="background: #f5f5f5; padding: 20px; text-align: left; overflow: auto; max-width: 800px; margin: 0 auto;">
                                ${error.toString()}
                                ${error.stack || ''}
                            </pre>
                            <p style="margin-top: 20px; color: #666; font-size: 12px;">
                                Check the browser console (F12) for more details.
                            </p>
                        </div>
                    `;
                }
            })
            .catch(error => {
                console.error('❌ Error loading app.js:', error);
                document.getElementById('root').innerHTML = `
                    <div style="padding: 50px; text-align: center; font-family: Arial;">
                        <h1 style="color: red; margin-bottom: 20px;">File Not Found</h1>
                        <p style="color: #666; margin-bottom: 20px;">
                            Could not load <strong>app.js</strong> file.
                        </p>
                        <p style="color: #666; margin-bottom: 10px;">Possible reasons:</p>
                        <ul style="text-align: left; max-width: 500px; margin: 0 auto; color: #666;">
                            <li>app.js is not in the same folder as this HTML file</li>
                            <li>You're opening the file directly (file://) - use a web server</li>
                            <li>Server is not running - start with START_OPTIMIZED.bat</li>
                            <li>File permissions issue</li>
                        </ul>
                        <p style="margin-top: 20px; color: #666; font-size: 12px;">
                            Error: ${error.message}
                        </p>
                        <p style="margin-top: 20px; color: #666; font-size: 12px;">
                            <strong>Solution:</strong> Make sure the server is running (START_OPTIMIZED.bat) 
                            and access via http://localhost:3000/app.html
                        </p>
                    </div>
                `;
            });
    </script>
</body>
</html>

